<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Details about each evaluation metrics • poem</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details about each evaluation metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/poem.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/table.html">Details about each evaluation metrics</a></li>
    <li><a class="dropdown-item" href="../articles/SpatialExperiment.html">Working with SpatialExperiment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RoseYuan/poem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="table_files/kePrint-0.0.1/kePrint.js"></script><link href="table_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Details about each evaluation metrics</h1>
                        <h4 data-toc-skip class="author">Siyuan Luo</h4>
            <address class="author_afil">
      Institute for Molecular Life Sciences, University of Zurich,
Zurich, SwitzerlandDepartment of Health Sciences and Technology, ETH
Zurich, Zurich,
Switzerland<br><a class="author_email" href="mailto:#"></a><a href="mailto:roseluosy@gmail.com" class="email">roseluosy@gmail.com</a>
      </address>
                              <h4 data-toc-skip class="author">Pierre-Luc
Germain</h4>
            <address class="author_afil">
      Institute for Molecular Life Sciences, University of Zurich,
Zurich, SwitzerlandDepartment of Health Sciences and Technology, ETH
Zurich, Zurich, Switzerland<br><h4 data-toc-skip class="date">2024-12-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/RoseYuan/poem/blob/HEAD/vignettes/table.rmd" class="external-link"><code>vignettes/table.rmd</code></a></small>
      <div class="d-none name"><code>table.rmd</code></div>
    </address>
</div>

    
    
<style type="text/css">
.smaller {
  font-size: 10px
}
</style>
<div class="section level2">
<h2 id="partition-based-metrics">Partition-based metrics<a class="anchor" aria-label="anchor" href="#partition-based-metrics"></a>
</h2>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Partition-based metrics. The notation used is common throughout the
table: consider comparing the predicted partition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
to the ground-truth partition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the number of pairs that are in the same group both in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the number of pairs that are in the same class in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
but in different clusters in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
is the number of pairs that are in different classes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
but in the same cluster in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
is the number of pairs that are in different groups both in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the total number of objects;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
is the expectation operator;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(⋅)</annotation></semantics></math>
is the Shannon entropy; <span class="math inline">$eta$</span> is the
ratio of weight attributed to homogeneity vs completeness; the
expactation value of RI, WH, and WC is calculated when assuming a
generalized hypergeometric model.
</caption>
<thead><tr>
<th style="text-align:left;">
Min_level
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Calculation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Rand Index (RI)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>a</mi><mo>+</mo><mi>d</mi></mrow><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow></mfrac><annotation encoding="application/x-tex">\frac{a+d}{n(n-1)/2}</annotation></semantics></math>;
the ratio of the sum of true positive and true negative pairs to the
total number of object pairs.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Wallace Homogeneity (WH)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>a</mi><mrow><mi>a</mi><mo>+</mo><mi>c</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{a}{a+c}</annotation></semantics></math>;
the ratio of the true positive pairs to the total number of object pairs
that are in the same cluster in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Wallace Completeness (WC)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>a</mi><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{a}{a+b}</annotation></semantics></math>;
the ratio of the true positive pairs to the total number of object pairs
that are in the same classes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Adjusted Rand Index (ARI)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mtext mathvariant="normal">RI</mtext><mo>−</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">RI</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">RI</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>d</mi><mo>−</mo><mi>b</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>+</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>+</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\text{RI}-\mathrm{E}(\text{RI})}{1-\mathrm{E}(\text{RI})} = \frac{2(ad-bc)}{(a+b)(b+d)+(a+c)(c+d)}</annotation></semantics></math>;
adjusting RI by accounting for the expected similarity of all pairings
due to chance using the Permutation Model for clusterings. ARI is the
harmonic mean of AWH and AWC.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Normalized Class Size Rand Index (NCR)
</td>
<td style="text-align:left;">
A normalized version of RI, where each concordance quantities are
divided by the maximum possible concordance values for their respective
class.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Mutual Information (MI)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mo stretchy="false" form="prefix">|</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(G) - H(G|P)</annotation></semantics></math>;
the difference between the shannon entropy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
and the conditional entropy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Adjusted Wallace Homogeneity (AWH), Adjusted Wallace Completeness (AWC),
and Adjusted Mutual Information (AMI)
</td>
<td style="text-align:left;">
Chance adjusted version of WH, WC and MI, respectively. For a metric M,
the chance adjusted version of it is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mtext mathvariant="normal">M</mtext><mo>−</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">M</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">M</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{\text{M}-\mathrm{E}(\text{M})}{1-\mathrm{E}(\text{M})}</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
(Entropy-based) Homogeneity (EH)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mo stretchy="false" form="prefix">|</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">1-\frac{H(G|P)}{H(G)}</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>G</mi><mo>,</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H(G,P)\neq0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
otherwise; the ratio of MI to the individual entropy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
(Entropy-based) Completeness (EC)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="false" form="prefix">|</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">1-\frac{H(P|G)}{H(P)}</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><mo>,</mo><mi>G</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≠</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H(P,G)\neq0</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
otherwise; the ratio of MI to the individual entropy of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
V Measure (VM)
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mtext mathvariant="normal">EH</mtext><mo>×</mo><mtext mathvariant="normal">EC</mtext></mrow><mrow><mi>β</mi><mo>×</mo><mtext mathvariant="normal">EH</mtext><mo>+</mo><mtext mathvariant="normal">EC</mtext></mrow></mfrac><annotation encoding="application/x-tex">\frac{(1+\beta)\times\text{EH}\times\text{EC}}{\beta\times\text{EH}+\text{EC}}</annotation></semantics></math>;
the harmonic mean between EH and EC. It is identical to normalized
mutual information (NMI) when arithmetic mean is used for averaging in
NMI calculation.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
(weighted average) F Measure (wFM)
</td>
<td style="text-align:left;">
Here we calculate weighted F1-score, where the weights are based on the
sizes of classes.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="embedding-based-metrics">Embedding-based metrics<a class="anchor" aria-label="anchor" href="#embedding-based-metrics"></a>
</h2>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Embedding-based metrics.
</caption>
<thead><tr>
<th style="text-align:left;">
Min_level
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Calculation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Silhouette score
</td>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>n</mi><mo>−</mo><mi>m</mi></mrow><mrow><mtext mathvariant="normal">max</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{n-m}{\text{max}(m, n)}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the mean distance between a sample and the nearest class that the
sample is not a part of, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the mean intra-class distance.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Composed Density between and within Clusters (CDbw)
</td>
<td style="text-align:left;">
The CDbw index consists of three main components: cohesion, compactness,
and separation between clusters. It uses multiple representative points
selected from each cluster to calculate intra-cluster density and
between-cluster distances, reflecting the geometry of the clusters and
capturing changes in intra-cluster density.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Density Based Clustering Validation index (DBCV)
</td>
<td style="text-align:left;">
A density-based index that computes the least dense region inside a
cluster and the most dense region between the clusters, to measure the
within and between cluster density connectedness of clusters.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="graph-based-metrics">Graph-based metrics<a class="anchor" aria-label="anchor" href="#graph-based-metrics"></a>
</h2>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Graph-based metrics.
</caption>
<thead><tr>
<th style="text-align:left;">
Min_level
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Calculation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Modularity
</td>
<td style="text-align:left;">
For a given graph partition, it quantifies the number of edges within
communities relative to what would be expected by random chance.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><msub><mo>∑</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>γ</mi><mfrac><mrow><msub><mi>k</mi><mi>i</mi></msub><msub><mi>k</mi><mi>j</mi></msub></mrow><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q = \frac{1}{2m} \sum_{ij} \left( A_{ij} - \gamma \frac{k_i k_j}{2m} \right) \delta(c_i, c_j)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the number of edges,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is the adjacency matrix of the graph,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>i</mi></msub><annotation encoding="application/x-tex">k_i</annotation></semantics></math>
is the (weighted) degree of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
is the resolution parameter, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>c</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta(c_i, c_j)</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
are in the same community else
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Local Inverse Simpson’s Index (LISI)
</td>
<td style="text-align:left;">
For a given node in a weighted kNN graph, the expected number of nodes
needed to be sampled before two nodes are drawn from the same classes
within its neighborhood.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Neighborhood Purity (NP)
</td>
<td style="text-align:left;">
For each node in a graph, the proportion of its neighborhood that is of
the same class as it.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Proportion of Weakly Connected (PWC)
</td>
<td style="text-align:left;">
For a given community in a graph, the proportion of nodes that have more
connections to the outside of the community than the inside of the
community.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Cohesion
</td>
<td style="text-align:left;">
The minimum number of nodes that must be removed to split a graph.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Adhesion
</td>
<td style="text-align:left;">
The minimum number of edges that must be removed to split a graph.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Adjusted Mean Shortest Path (AMSP)
</td>
<td style="text-align:left;">
A measure of the disconnectness and spread of the subgraph connecting
elements of a given class. If the graph subclass is disconnected, the
mean shortest path of each connected subgraph
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
are summed.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><msub><mo>∑</mo><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><mi>N</mi></msqrt></mfrac><annotation encoding="application/x-tex">\frac{\sum_{i} (1+m_i)}{\sqrt{N}}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the mean shortest path and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is the number of nodes of the given class. Note that the normalization
for size is only approximative, and only applicable for kNN graphs.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Neighborhood Class Enrichment (NCE)
</td>
<td style="text-align:left;">
The log2 fold-enrichment (i.e. over-representation) of the node’s class
among its nearest neighbors, over the expected given its relative
abundance.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="metrics-for-spatial-clusterings">Metrics for spatial clusterings<a class="anchor" aria-label="anchor" href="#metrics-for-spatial-clusterings"></a>
</h2>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Metrics for spatial clusterings.
</caption>
<thead><tr>
<th style="text-align:left;">
Min_level
</th>
<th style="text-align:left;">
Metric
</th>
<th style="text-align:left;">
Calculation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Percentage of Abnormal Spots (PAS)
</td>
<td style="text-align:left;">
PAS measures the percentage of abnormal spots, which is defined as spots
with a spatial domain label differing from more than half of its nearest
neighbors.
</td>
</tr>
<tr>
<td style="text-align:left;">
class/cluster
</td>
<td style="text-align:left;">
Spatial Chaos Score (CHAOS)
</td>
<td style="text-align:left;">
CHAOS is the mean length of the graph edges in the 1-nearest neighbor
(1NN) graph for each domain averaged across domains.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Entropy-based Local indicator of Spatial Association (ELSA)
</td>
<td style="text-align:left;">
For a site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>a</mi><mi>i</mi></mrow></msub><mo>×</mo><msub><mi>E</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_i = E_{ai} \times E_{ci}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>a</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">E_{ai}</annotation></semantics></math>
summarizes the dissimilarity between site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and the neighbouring sites, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>c</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">E_{ci}</annotation></semantics></math>
quantifies the diversity of the categories within the neighbourhood of
site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Spatial RI, ARI, WH, WC, AWH, and AWC
</td>
<td style="text-align:left;">
Spatial versions of the pair-sorting indices, based on fuzzy versions of
the metrics. Specifically, we use the Normalized Degree of Concordance
(NDC, see Hullermeier et al., 2012) and the Adjusted Concordance Index
(ACI, see D’Errico et al., 2021) as fuzzy versions of RI and ARI
respectively, and developed fuzzy versions of the other metrics using
the same logic. In the spatial context, we first make a fuzzy version of
the true labels based on the spatial neighborhood, and then track the
maximum pair concordance between the predicted labels and either the
hard or fuzzy ground truth.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Spot-wise Pair Concordance (SPC)
</td>
<td style="text-align:left;">
The proportion, for each spot, of the pairs it forms with all other
spots that are concordant (i.e. in the same partition or not in both)
across the clustering and ground truth. This value will be the same for
all spots that share the same combination of cluster and class, and is
especially useful for visualization. A variant of this can be computed
that ignores negative pairs (i.e. that are discordant in both the
clustering and ground truth). When negative pairs are included, the
average of SPC equals to the Rand Index.
</td>
</tr>
<tr>
<td style="text-align:left;">
element
</td>
<td style="text-align:left;">
Spatial SPC
</td>
<td style="text-align:left;">
Like the non-spatial Spot-wise Pair Concordance, with the difference
that the clustering is evaluated against both a ‘hard’ and ‘fuzzy’
version of the ground truth, as for the computation of the Spatial
versions of the pair-sorting indices.
</td>
</tr>
<tr>
<td style="text-align:left;">
dataset
</td>
<td style="text-align:left;">
Spatial Set Matching Accuracy
</td>
<td style="text-align:left;">
An accuracy that downweights misclassifications based on the spatial
neighborhood. Instead of counting as zero in the accuracy computation,
the misclassified node counts as the proportion of its spatial
neighborhood that is of node’s predicted class.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BiocStyle_2.32.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] vctrs_0.6.5         svglite_2.1.3       cli_3.6.3          </span></span>
<span><span class="co">##  [4] knitr_1.48          rlang_1.1.4         xfun_0.46          </span></span>
<span><span class="co">##  [7] stringi_1.8.4       textshaping_0.3.6   jsonlite_1.8.8     </span></span>
<span><span class="co">## [10] glue_1.8.0          colorspace_2.1-1    htmltools_0.5.8.1  </span></span>
<span><span class="co">## [13] ragg_1.3.2          sass_0.4.9          scales_1.3.0       </span></span>
<span><span class="co">## [16] rmarkdown_2.27      munsell_0.5.1       evaluate_0.24.0    </span></span>
<span><span class="co">## [19] jquerylib_0.1.4     kableExtra_1.4.0    fastmap_1.2.0      </span></span>
<span><span class="co">## [22] yaml_2.3.10         lifecycle_1.0.4     bookdown_0.40      </span></span>
<span><span class="co">## [25] stringr_1.5.1       BiocManager_1.30.23 compiler_4.4.2     </span></span>
<span><span class="co">## [28] fs_1.6.4            htmlwidgets_1.6.4   rstudioapi_0.16.0  </span></span>
<span><span class="co">## [31] systemfonts_1.1.0   digest_0.6.36       viridisLite_0.4.2  </span></span>
<span><span class="co">## [34] R6_2.5.1            magrittr_2.0.3      bslib_0.8.0        </span></span>
<span><span class="co">## [37] tools_4.4.2         xml2_1.3.6          pkgdown_2.1.1      </span></span>
<span><span class="co">## [40] cachem_1.1.0        desc_1.4.3</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://roseyuan.github.io/" class="external-link">Siyuan Luo</a>, Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
