<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to `poem` • poem</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `poem`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">poem</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.17</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/poem.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/MetricsInPoem.html">Details about each evaluation metrics</a></li>
    <li><a class="dropdown-item" href="../articles/PoemOnSpatialExperiment.html">Working with SpatialExperiment</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RoseYuan/poem/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="poem_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="poem_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="poem_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="poem_files/datatables-binding-0.33/datatables.js"></script><link href="poem_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="poem_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="poem_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="poem_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="poem_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to `poem`</h1>
                        <h4 data-toc-skip class="author">Siyuan Luo</h4>
            <address class="author_afil">
      Institute for Molecular Life Sciences, University of Zurich,
Zurich, SwitzerlandDepartment of Health Sciences and Technology, ETH
Zurich, Zurich,
Switzerland<br><a class="author_email" href="mailto:#"></a><a href="mailto:roseluosy@gmail.com" class="email">roseluosy@gmail.com</a>
      </address>
                              <h4 data-toc-skip class="author">Pierre-Luc
Germain</h4>
            <address class="author_afil">
      Institute for Molecular Life Sciences, University of Zurich,
Zurich, SwitzerlandDepartment of Health Sciences and Technology, ETH
Zurich, Zurich, Switzerland<br><h4 data-toc-skip class="date">2025-04-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/RoseYuan/poem/blob/HEAD/vignettes/poem.Rmd" class="external-link"><code>vignettes/poem.Rmd</code></a></small>
      <div class="d-none name"><code>poem.Rmd</code></div>
    </address>
</div>

    
    
<style type="text/css">
.smaller {
  font-size: 10px
}
</style>
<div class="section level2">
<h2 class="unnumbered" id="installation-loading">Installation &amp; loading<a class="anchor" aria-label="anchor" href="#installation-loading"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"poem"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://roseyuan.github.io/poem/">poem</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/briatte/ggnetwork" class="external-link">ggnetwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="what-is-this-package-for">What is this package for?<a class="anchor" aria-label="anchor" href="#what-is-this-package-for"></a>
</h3>
<p>This package provides multiple approaches for comparing two
partitions<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;A partition is a way of organizing the data points of a
dataset into distinct, non-overlapping, and non-empty subsets. For
example, a clustering is a partition.&lt;/p&gt;"><sup>1</sup></a> of the same dataset, and evaluating the
alignment between a dataset’s embedding/graph representations and its
partition.</p>
<p>Besides, this package further offers methods for comparing two fuzzy
partitions<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In ‘hard’ partitions, each data point belongs to one and
only one subset. However, clustering can also generate fuzzy partitions,
in which data points can belong to multiple subsets with varying degrees
(or probability) of membership.&lt;/p&gt;"><sup>2</sup></a> as well as for comparing a hard partition
with a fuzzy partition. This allows the evaluation of fuzzy partition
results by assessing its agreement to a fuzzy or a hard ground-truth
partition.</p>
<p>Finally, the package implements visualization and evaluation metrics
tailored for domain detection in spatially-resolved -omics data. These
include especially external evaluation metrics (i.e. based on a
comparison to ground truth labels), but also internal metrics. For a
detailed description on how to work with <em><a href="https://bioconductor.org/packages/3.19/SpatialExperiment" class="external-link">SpatialExperiment</a></em>
objects, we refer to another vignette of <em><a href="https://bioconductor.org/packages/3.19/poem/vignettes/PoemOnSpatialExperiment.html" class="external-link">poem</a></em>.</p>
</div>
<div class="section level3">
<h3 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h3>
<p>The package <em>poem</em> includes many metrics to perform different
kinds of evaluations, and these metrics can be retrieved via 6 main
wrapper functions. Unless specified, “partition” means “hard” partition.
They are:</p>
<ul>
<li>
<code><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics()</a></code>: Metrics to compare an embedding
of data points to a partition of these data points.</li>
<li>
<code><a href="../reference/getGraphMetrics.html">getGraphMetrics()</a></code>: Metrics to compare a graph
(e.g. kNN/sNN) to a partition, where nodes in the graph are data points
in the partition.</li>
<li>
<code><a href="../reference/getPartitionMetrics.html">getPartitionMetrics()</a></code>: Metrics to compare two
partitions of the same dataset.</li>
<li>
<code>getfuzzyPartitionMetrics()</code>: Metrics to compare two
fuzzy partitions, or to compare between a fuzzy and a hard partition of
the same dataset.</li>
<li>
<code><a href="../reference/getSpatialExternalMetrics.html">getSpatialExternalMetrics()</a></code>: External metrics for
evaluating spatial clustering results in a spatial-aware fashion. For
non-spatial-aware evaluation, one can directly use
<code><a href="../reference/getPartitionMetrics.html">getPartitionMetrics()</a></code>.</li>
<li>
<code><a href="../reference/getSpatialInternalMetrics.html">getSpatialInternalMetrics()</a></code>: Internal metrics for
evaluating spatial clustering results in a spatial-aware fashion.</li>
</ul>
<p>There are 3 different levels where one can perform the
above-mentioned evaluation: element-level, class-level, and
dataset-level. Element-level evaluation reports metric values for each
data point; Class-level evaluation reports metrics for each classes<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In this vignette, classes refer to groups in the
&lt;strong&gt;ground-truth&lt;/strong&gt; partition.&lt;/p&gt;"><sup>3</sup></a> or
clusters<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In this vignette, clusters refer to groups in the
&lt;strong&gt;predicted&lt;/strong&gt; partition.&lt;/p&gt;"><sup>4</sup></a>; and dataset-level evaluation returns a
single metric value for the whole dataset.</p>
<p>The following table illustrates available metrics at different
evaluation levels, and the main functions used to retrieve them.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metric_info</span><span class="op">)</span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">metric_info</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65"],["AMI","AMSP","ARI","ASPC","AWC","AWH","Accuracy","CHAOS","EC","EH","ELSA","FM","ISI","MHM","MI","MMM","MPC","Mirkin","NCE","NCR","NP","NPC","PAS","PC","PE","PWC","RI","SI","SPC","SW","SpatialARI","SpatialAccuracy","SpatialRI","SpatialSPC","VDM","VI","VM","WC","WH","adhesion","cdbw","cohesion (cdbw)","cohesion (graph)","compactness","dbcv","fuzzyARI","fuzzyAWC","fuzzyAWH","fuzzyRI","fuzzySPC","fuzzyWC","fuzzyWH","meanClassSW","meanSW","minClassSW","minSW","nsARI","nsAWC","nsAWH","nsRI","nsSPC","nsWC","nsWH","pnSW","sep"],["dataset","class, dataset","dataset","element","class, dataset","class, dataset","dataset","class, dataset","dataset","dataset","element, class, dataset","class, dataset","element, class, dataset","dataset","dataset","dataset","dataset","dataset","element, class, dataset","dataset","element, class, dataset","element","element, class, dataset","dataset","dataset","class, dataset","dataset","element, class, dataset","element","element","dataset","dataset","dataset","element","dataset","dataset","dataset","class, dataset","class, dataset","class, dataset","dataset","dataset","class, dataset","dataset","class, dataset","dataset","class, dataset","class, dataset","dataset","element","class, dataset","class, dataset","dataset","class, dataset","dataset","class","dataset","class, dataset","class, dataset","dataset","element","class, dataset","class, dataset","class, dataset","dataset"],["getPartitionMetrics","getGraphMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getSpatialInternalMetrics","getPartitionMetrics","getPartitionMetrics","getSpatialInternalMetrics","getPartitionMetrics","getGraphMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getSpatialInternalMetrics","getPartitionMetrics","getGraphMetrics","getPartitionMetrics","getGraphMetrics","getSpatialExternalMetrics","getSpatialInternalMetrics","getSpatialInternalMetrics","getSpatialInternalMetrics","getGraphMetrics","getPartitionMetrics","getGraphMetrics","getPartitionMetrics","getEmbeddingMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getPartitionMetrics","getGraphMetrics","getEmbeddingMetrics","getEmbeddingMetrics","getGraphMetrics","getEmbeddingMetrics","getEmbeddingMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getFuzzyPartitionMetrics","getEmbeddingMetrics","getEmbeddingMetrics","getEmbeddingMetrics","getEmbeddingMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getSpatialExternalMetrics","getEmbeddingMetrics","getEmbeddingMetrics"],["Adjusted Mutual Information","Adjusted Mean Shortest Path","Adjusted Rand Index","Adjusted Spot-wise Pair Concordance","Adjusted Wallace Completeness","Adjusted Wallace Homogeneity","Set-matching Accuracy","Spatial Chaos Score","(Entropy-based) Completeness","(Entropy-based) Homogeneity","Entropy-based Local Indicator of Spatial Association (ELSA score)","F-measure/weighted average F1 score","Inverse Simpson’s Index","Meila-Heckerman Measure","Mutual Information","Maximum-Match Measure","Modified Partition Coefficient","Mirkin Metric","Neighborhood Class Enrichment","Normalized Class Size Rand Index","Neighborhood Purity","Neighboring Pair Concordance for Spatial Clustering","Proportion of Abnormal Spots (PAS score)","Partition Coefficient","Partition Entropy","Proportion of Weakly Connected","Rand Index","Simpson’s Index","Spot-wise Pair Concordance","Silhouette Width","Adjusted Rand Index weighted by distance for Spatial Clustering","Set-matching Accuracy for Spatial Clustering","Rand Index weighted by distance for Spatial Clustering","Spot-wise Pair Concordance weighted by distance for Spatial Clustering","Van Dongen Measure","Variation of Information","V-measure","Wallace Completeness","Wallace Homogeneity","Adhesion of a graph","Composed Density between and within Clusters (CDbw)","CDbw Cohesion","Cohesion of a graph","CDbw Compactness","Density Based Clustering Validation Index (DBCV)","Fuzzy version of Adjusted Rand Index","Fuzzy version of Adjusted Wallace Completeness","Fuzzy version of Adjusted Wallace Homogeneity","Fuzzy version of Rand Index","Fuzzy version of Spot-wise Pair Concordance","Fuzzy version of Wallace Completeness","Fuzzy version of Wallace Homogeneity","Mean of Class-level Silhouette Width","Mean Silhouette Width","Minimal of Class-level Silhouette Width","Minimal Silhouette Width","Neighborhood smoothed Adjusted Rand Index for Spatial Clustering","Neighborhood smoothed Adjusted Wallace Completeness for Spatial Clustering","Neighborhood smoothed Adjusted Wallace Homogeneity for Spatial Clustering","Neighborhood smoothed Rand Index for Spatial Clustering","Neighborhood smoothed Spot-wise Pair Concordance for Spatial Clustering","Neighborhood smoothed Wallace Completeness for Spatial Clustering","Neighborhood smoothed Wallace Homogeneity for Spatial Clustering","Proportion of Negative Silhouette Width","CDbw seperation"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Name<\/th>\n      <th>Levels<\/th>\n      <th>MainFunction<\/th>\n      <th>Description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Name","targets":1},{"name":"Levels","targets":2},{"name":"MainFunction","targets":3},{"name":"Description","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>To showcase the main functions, we will use some simulated datasets
as examples in this vignette.</p>
<p>The two datasets, <code>g1</code> and <code>g2</code>, both contain
80 data points with <code>x</code> and <code>y</code> coordinates and of
4 different classes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toyExamples</span><span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">toyExamples</span><span class="op">[</span><span class="va">toyExamples</span><span class="op">$</span><span class="va">graph</span><span class="op">==</span><span class="st">"graph1"</span>,<span class="op">]</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">toyExamples</span><span class="op">[</span><span class="va">toyExamples</span><span class="op">$</span><span class="va">graph</span><span class="op">==</span><span class="st">"graph2"</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span><span class="co">##      graph          x         y  class</span></span>
<span><span class="co">## 641 graph1 -0.6290416 -0.487293 class1</span></span>
<span><span class="co">## 642 graph1 -2.5646982 -1.742079 class1</span></span>
<span><span class="co">## 643 graph1 -1.6368716 -1.911560 class1</span></span>
<span><span class="co">## 644 graph1 -1.3671374 -2.120897 class1</span></span>
<span><span class="co">## 645 graph1 -1.5957317 -3.194329 class1</span></span>
<span><span class="co">## 646 graph1 -2.1061245 -1.388003 class1</span></span></code></pre></div>
<p>If we plot them out:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,color<span class="op">=</span><span class="va">class</span>, shape<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">graph</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="embedding-evaluation">Embedding evaluation<a class="anchor" aria-label="anchor" href="#embedding-evaluation"></a>
</h2>
<p>Let’s assume <code>g1</code> and <code>g2</code> contain two
different embeddings of the same set of objects. A “good” embedding
should put objects of the same class together, and objects of different
class apart. Since we know the ground-truth class of each object, one
can evaluation such “goodness” of an embedding by calculating embedding
evaluation metrics. One can calculate such metrics element-wise, for
each class/cluster, or for the whole dataset.</p>
<div class="section level3">
<h3 id="element-level-evaluation">Element-level evaluation<a class="anchor" aria-label="anchor" href="#element-level-evaluation"></a>
</h3>
<p>For example, at the element level, one can calculate the Silhouette
Width by specifying <code>level="element"</code> and
<code>metrics=c("SW")</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>, metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SW"</span><span class="op">)</span>,</span>
<span>                          level<span class="op">=</span><span class="st">"element"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sw</span><span class="op">)</span></span>
<span><span class="co">##      class        SW</span></span>
<span><span class="co">## 641 class1 0.2986628</span></span>
<span><span class="co">## 642 class1 0.5818507</span></span>
<span><span class="co">## 643 class1 0.6299871</span></span>
<span><span class="co">## 644 class1 0.5867285</span></span>
<span><span class="co">## 645 class1 0.5191290</span></span>
<span><span class="co">## 646 class1 0.5679847</span></span></code></pre></div>
<p>The output will be a <code>data.frame</code> containing the metric
values for the specified level.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g1</span><span class="op">$</span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                             metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SW"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"element"</span><span class="op">)</span><span class="op">$</span><span class="va">SW</span></span>
<span><span class="va">g2</span><span class="op">$</span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                             metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SW"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"element"</span><span class="op">)</span><span class="op">$</span><span class="va">SW</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color<span class="op">=</span><span class="va">sw</span>, shape<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">graph</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="class-level-evaluation">Class-level evaluation<a class="anchor" aria-label="anchor" href="#class-level-evaluation"></a>
</h3>
<p>One can also evaluate at each class level, by specifying
<code>level="class"</code>. Check <code><a href="../reference/getEmbeddingMetrics.html">?getEmbeddingMetrics</a></code> to
see what are the allowed metrics at the class level. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                          metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dbcv"</span>, <span class="st">"meanSW"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="co">##    class    meanSW        dbcv</span></span>
<span><span class="co">## 1 class1 0.4240817 -0.37367780</span></span>
<span><span class="co">## 2 class2 0.4897828 -0.34617982</span></span>
<span><span class="co">## 3 class3 0.5021555  0.07752233</span></span>
<span><span class="co">## 4 class4 0.5957709  0.26757842</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                            metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dbcv"</span>, <span class="st">"meanSW"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                            metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dbcv"</span>, <span class="st">"meanSW"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>graph1<span class="op">=</span><span class="va">res1</span>, graph2<span class="op">=</span><span class="va">res2</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"graph"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meanSW"</span>,<span class="st">"dbcv"</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"metric"</span>,values_to<span class="op">=</span><span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span>, <span class="va">value</span>, fill<span class="op">=</span><span class="va">graph</span>, group<span class="op">=</span><span class="va">graph</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metric</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="dataset-level-evaluation">Dataset-level evaluation<a class="anchor" aria-label="anchor" href="#dataset-level-evaluation"></a>
</h3>
<p>Similarly, one can evaluate at the dataset level by specifying
<code>level="dataset"</code>. For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getEmbeddingMetrics.html">getEmbeddingMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                    metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meanSW"</span>, <span class="st">"meanClassSW"</span>, <span class="st">"pnSW"</span>, <span class="st">"minClassSW"</span>,</span>
<span>                              <span class="st">"cdbw"</span>, <span class="st">"cohesion"</span>, <span class="st">"compactness"</span>, <span class="st">"sep"</span>, <span class="st">"dbcv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##      meanSW meanClassSW   pnSW minClassSW      cdbw  cohesion compactness</span></span>
<span><span class="co">## 1 0.5029477   0.5029477 0.0375  0.4240817 0.0553208 0.2732925   0.2800803</span></span>
<span><span class="co">##         sep        dbcv</span></span>
<span><span class="co">## 1 0.7227335 -0.09368922</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="graph-evaluation">Graph evaluation<a class="anchor" aria-label="anchor" href="#graph-evaluation"></a>
</h2>
<p>Instead of directly using the distances or densities in the embedding
space for evaluation, one may want to evaluate from a connectivity stand
point by looking at the graph structure constructed from the above
datasets. <code><a href="../reference/getGraphMetrics.html">getGraphMetrics()</a></code> can perform k nearest neighbor
(KNN) graph or shared nearest neighbor graph (SNN) construction from an
embedding and then apply graph-based evaluation metrics.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Some functions for plotting</span></span>
<span><span class="va">plotGraphs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>, <span class="va">k</span><span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">gn</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="va">d</span><span class="op">$</span><span class="va">graph</span><span class="op">)</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emb2knn.html">emb2knn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, k<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">poem</span><span class="fu">:::</span><span class="fu">.nn2graph</span><span class="op">(</span><span class="va">nn</span>, labels<span class="op">=</span><span class="va">d1</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggnetwork/man/ggnetwork.html" class="external-link">ggnetwork</a></span><span class="op">(</span><span class="va">g</span>, layout<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">d1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"graph"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gn</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggnetwork/man/theme_blank.html" class="external-link">theme_blank</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggnetwork/man/geom_edges.html" class="external-link">geom_edges</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, colour<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ggnetwork/man/geom_nodes.html" class="external-link">geom_nodes</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">class</span>, shape<span class="op">=</span><span class="va">class</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">graph</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For our examples <code>g1</code> and <code>g2</code>, the constructed
graphs will look like:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotGraphs</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"graph"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Use <code>?getGraphMetrics()</code> to check optional arguments for
KNN/SNN graph construction.</p>
<p>Similarly, <code>level</code> can be <code>"element"</code>,
<code>"class"</code> or <code>"dataset"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getGraphMetrics.html">getGraphMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>, metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PWC"</span>,<span class="st">"ISI"</span><span class="op">)</span>,</span>
<span>                level<span class="op">=</span><span class="st">"class"</span>, directed<span class="op">=</span><span class="cn">FALSE</span>, k<span class="op">=</span><span class="fl">7</span>, shared<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">##         class  PWC      ISI</span></span>
<span><span class="co">## class1 class1 0.05 1.186272</span></span>
<span><span class="co">## class2 class2 0.10 1.224188</span></span>
<span><span class="co">## class3 class3 0.05 1.149098</span></span>
<span><span class="co">## class4 class4 0.05 1.251146</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGraphMetrics.html">getGraphMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                        labels<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>,metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PWC"</span>,<span class="st">"ISI"</span><span class="op">)</span>, </span>
<span>                        level<span class="op">=</span><span class="st">"class"</span>, directed<span class="op">=</span><span class="cn">FALSE</span>, k<span class="op">=</span><span class="fl">7</span>, shared<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGraphMetrics.html">getGraphMetrics</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">g2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">class</span>, </span>
<span>                        metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PWC"</span>,<span class="st">"ISI"</span><span class="op">)</span>, level<span class="op">=</span><span class="st">"class"</span>, </span>
<span>                        directed<span class="op">=</span><span class="cn">FALSE</span>, k<span class="op">=</span><span class="fl">7</span>, shared<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>graph1<span class="op">=</span><span class="va">res1</span>, graph2<span class="op">=</span><span class="va">res2</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"graph"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PWC"</span>,<span class="st">"ISI"</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"metric"</span>,values_to<span class="op">=</span><span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">class</span>, <span class="va">value</span>, fill<span class="op">=</span><span class="va">graph</span>, group<span class="op">=</span><span class="va">graph</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span>, stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metric</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>Alternatively, <code><a href="../reference/getGraphMetrics.html">getGraphMetrics()</a></code> can take an
<em>igraph</em> object as <code>x</code>, which enables the application
of the evaluation metrics to a general graph, or a list of nearest
neighbors as <code>x</code>, to accelerate the computation for large
datasets.</p>
</div>
<div class="section level2">
<h2 id="partition-evaluation">Partition evaluation<a class="anchor" aria-label="anchor" href="#partition-evaluation"></a>
</h2>
<p>We construct SNN graph from g1 and g2 embeddings, and then apply
Louvain algorithm to get partitions out of them.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">snn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emb2snn.html">emb2snn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">g1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, k<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span><span class="va">snn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emb2snn.html">emb2snn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">g2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, k<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span><span class="va">g1</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cluster_louvain.html" class="external-link">cluster_louvain</a></span><span class="op">(</span><span class="va">snn1</span>, resolution <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">$</span><span class="va">membership</span><span class="op">)</span></span>
<span><span class="va">g2</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cluster_louvain.html" class="external-link">cluster_louvain</a></span><span class="op">(</span><span class="va">snn2</span>, resolution <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">$</span><span class="va">membership</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">g1</span>,<span class="va">g2</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,color<span class="op">=</span><span class="va">cluster</span>, shape<span class="op">=</span><span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">graph</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>We then compare the predictions with the known labels using the
partition metrics:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for g1</span></span>
<span><span class="fu"><a href="../reference/getPartitionMetrics.html">getPartitionMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>, pred<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">cluster</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RI"</span>, <span class="st">"WC"</span>, <span class="st">"WH"</span>, <span class="st">"ARI"</span>, <span class="st">"AWC"</span>, <span class="st">"AWH"</span>,</span>
<span>                                <span class="st">"FM"</span>, <span class="st">"AMI"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##          RI    WC        WH       ARI       AWC       AWH        FM       AMI</span></span>
<span><span class="co">## 1 0.9636076 0.925 0.9237845 0.9004285 0.9012088 0.8996496 0.9624922 0.8872892</span></span>
<span></span>
<span><span class="co"># for g2</span></span>
<span><span class="fu"><a href="../reference/getPartitionMetrics.html">getPartitionMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">class</span>, pred<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">cluster</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                    metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RI"</span>, <span class="st">"WC"</span>, <span class="st">"WH"</span>, <span class="st">"ARI"</span>, <span class="st">"AWC"</span>, <span class="st">"AWH"</span>,</span>
<span>                                <span class="st">"FM"</span>, <span class="st">"AMI"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##         RI   WC        WH       ARI       AWC       AWH        FM       AMI</span></span>
<span><span class="co">## 1 0.721519 0.95 0.4616368 0.4400954 0.9010025 0.2911552 0.6501669 0.4193846</span></span></code></pre></div>
<p>Note that for class-level metrics, some are reported per class, while
some (specifically, “WH”, “AWH) are reported per cluster.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getPartitionMetrics.html">getPartitionMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">g1</span><span class="op">$</span><span class="va">class</span>, pred<span class="op">=</span><span class="va">g2</span><span class="op">$</span><span class="va">cluster</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span><span class="co">##    WC      AWC        FM  class        WH       AWH cluster</span></span>
<span><span class="co">## 1 0.9 0.802005 0.6551724 class1        NA        NA    &lt;NA&gt;</span></span>
<span><span class="co">## 2 0.9 0.802005 0.6551724 class2        NA        NA    &lt;NA&gt;</span></span>
<span><span class="co">## 3 1.0 1.000000 0.6451613 class3        NA        NA    &lt;NA&gt;</span></span>
<span><span class="co">## 4 1.0 1.000000 0.6451613 class4        NA        NA    &lt;NA&gt;</span></span>
<span><span class="co">## 5  NA       NA        NA   &lt;NA&gt; 0.4864865 0.3238739       1</span></span>
<span><span class="co">## 6  NA       NA        NA   &lt;NA&gt; 0.4413473 0.2644406       2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fuzzy-partition-evaluation">Fuzzy partition evaluation<a class="anchor" aria-label="anchor" href="#fuzzy-partition-evaluation"></a>
</h2>
<p>For comparing two fuzzy partitions or comparing a fuzzy partition to
a hard patition, one can use
<code><a href="../reference/getFuzzyPartitionMetrics.html">getFuzzyPartitionMetrics()</a></code>.</p>
<p>The fuzzy reprensentation of a partion should look like the
following, where each row is a data point, and the value is the class
memberships to each class. Each row sums up to 1.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fuzzyTrue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.95</span>, <span class="fl">0.025</span>, <span class="fl">0.025</span>, </span>
<span>  <span class="fl">0.98</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, </span>
<span>  <span class="fl">0.96</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, </span>
<span>  <span class="fl">0.95</span>, <span class="fl">0.04</span>, <span class="fl">0.01</span>, </span>
<span>  <span class="fl">0.95</span>, <span class="fl">0.01</span>, <span class="fl">0.04</span>, </span>
<span>  <span class="fl">0.99</span>, <span class="fl">0.005</span>, <span class="fl">0.005</span>, </span>
<span>  <span class="fl">0.025</span>, <span class="fl">0.95</span>, <span class="fl">0.025</span>, </span>
<span>  <span class="fl">0.97</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, </span>
<span>  <span class="fl">0.025</span>, <span class="fl">0.025</span>, <span class="fl">0.95</span><span class="op">)</span>, </span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a hard truth:</span></span>
<span><span class="va">hardTrue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">fuzzyTrue</span>,<span class="fl">1</span>,FUN<span class="op">=</span><span class="va">which.max</span><span class="op">)</span></span>
<span><span class="co"># some predicted labels:</span></span>
<span><span class="va">hardPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getFuzzyPartitionMetrics.html">getFuzzyPartitionMetrics</a></span><span class="op">(</span>hardPred<span class="op">=</span><span class="va">hardPred</span>, hardTrue<span class="op">=</span><span class="va">hardTrue</span>, </span>
<span>                         fuzzyTrue<span class="op">=</span><span class="va">fuzzyTrue</span>, nperms<span class="op">=</span><span class="fl">3</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span><span class="co">##     fuzzyWC  fuzzyAWC class    fuzzyWH   fuzzyAWH cluster</span></span>
<span><span class="co">## 1 0.7195238 0.3542847     1         NA         NA      NA</span></span>
<span><span class="co">## 2 1.0000000       NaN     2         NA         NA      NA</span></span>
<span><span class="co">## 3 1.0000000       NaN     3         NA         NA      NA</span></span>
<span><span class="co">## 4        NA        NA    NA 1.00000000  1.0000000       1</span></span>
<span><span class="co">## 5        NA        NA    NA 0.06166667 -0.8064171       2</span></span></code></pre></div>
<p>By using the input <code>hardPred</code>, <code>hardTrue</code>,
<code>fuzzyPred</code>, <code>fuzzyTrue</code>, one can control whether
the fuzzy or hard version of the two partitions is used in comparison.
For example, when <code>fuzzyTrue</code> and <code>fuzzyPred</code> are
not <code>NULL</code>, metrics for comparing two fuzzy partitions will
be used.</p>
</div>
<div class="section level2">
<h2 id="spatial-clustering-evaluation">Spatial clustering evaluation<a class="anchor" aria-label="anchor" href="#spatial-clustering-evaluation"></a>
</h2>
<div class="section level3">
<h3 id="example-data-1">Example data<a class="anchor" aria-label="anchor" href="#example-data-1"></a>
</h3>
<p>We use another toy example dataset in the package,
<code>sp_toys</code>, to illustrate spatial clustering evaluation.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sp_toys</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">s</span>, stroke <span class="op">=</span> <span class="va">st</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">p1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"P1"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">s</span>, stroke <span class="op">=</span> <span class="va">st</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"C"</span><span class="op">)</span> </span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">s</span>, stroke <span class="op">=</span> <span class="va">st</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">p2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"P2"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p0</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                     plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                     plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                     plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-21-1.png" width="816"></p>
<p>Here in C, the spots are colored by the ground-truth class. In P1 and
P2, the color inside each spot is according to the ground-truth class,
while the color of the border is according to clustering predictions. P1
and P2 misclassified the same amount of red spots into the blue
cluster.</p>
</div>
<div class="section level3">
<h3 id="external-metrics">External metrics<a class="anchor" aria-label="anchor" href="#external-metrics"></a>
</h3>
<p>Let’s quantify this by calculating external spatial metrics:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getSpatialExternalMetrics.html">getSpatialExternalMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nsARI"</span>,<span class="st">"SpatialARI"</span><span class="op">)</span>,</span>
<span>                      fuzzy_true <span class="op">=</span> <span class="cn">TRUE</span>, fuzzy_pred <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">##       nsARI SpatialARI</span></span>
<span><span class="co">## 1 0.7871135  0.7460029</span></span></code></pre></div>
<p>By specifying <code>fuzzy_true</code> and <code>fuzzy_pred</code>,
one can control whether the fuzzy or hard version of <code>true</code>
and <code>pred</code> is used in comparison for the
neighborhood-smoothed ARI (nsARI). If <code>fuzzy_true</code> or
<code>fuzzy_pred</code> is <code>TRUE</code>, the spatial neighborhood
information will be used to construct the fuzzy representation of the
class/cluster memberships.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getSpatialExternalMetrics.html">getSpatialExternalMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"class"</span><span class="op">)</span></span>
<span><span class="co">##        nsWH     nsAWH      nsWC     nsAWC class cluster</span></span>
<span><span class="co">## 1        NA        NA 0.8078698 0.5929504     1      NA</span></span>
<span><span class="co">## 2        NA        NA 1.0000000 1.0000000     2      NA</span></span>
<span><span class="co">## 3 1.0000000 1.0000000        NA        NA    NA       1</span></span>
<span><span class="co">## 4 0.8323893 0.6493279        NA        NA    NA       2</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpatialExternalMetrics.html">getSpatialExternalMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nsARI"</span>,<span class="st">"SpatialARI"</span><span class="op">)</span>,</span>
<span>                      fuzzy_true <span class="op">=</span> <span class="cn">TRUE</span>, fuzzy_pred <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">res2.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpatialExternalMetrics.html">getSpatialExternalMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p2</span>,</span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"dataset"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nsARI"</span>,<span class="st">"SpatialARI"</span><span class="op">)</span>,</span>
<span>                      fuzzy_true <span class="op">=</span> <span class="cn">TRUE</span>, fuzzy_pred <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">res1.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPartitionMetrics.html">getPartitionMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1</span>,</span>
<span>                      level<span class="op">=</span><span class="st">"dataset"</span>, metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARI"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res2.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPartitionMetrics.html">getPartitionMetrics</a></span><span class="op">(</span>true<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, pred<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p2</span>,</span>
<span>                      level<span class="op">=</span><span class="st">"dataset"</span>, metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ARI"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res1.1</span>, <span class="va">res2.1</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"P"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res1.2</span>, <span class="va">res2.2</span><span class="op">)</span>, .id<span class="op">=</span><span class="st">"P"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nsARI"</span>, <span class="st">"SpatialARI"</span>, <span class="st">"ARI"</span><span class="op">)</span>, </span>
<span>               names_to<span class="op">=</span><span class="st">"metric"</span>, values_to<span class="op">=</span><span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">P</span>, y<span class="op">=</span><span class="va">value</span>, group<span class="op">=</span><span class="va">metric</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metric</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Prediction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-25-1.png" width="480"></p>
<p>When the evaluation is non-spatial-aware, P1 and P2 get the same ARI
score. However, with spatial-aware metrics like nsARI and SpatialARI, P2
gets a higher scores than P1.</p>
</div>
<div class="section level3">
<h3 id="internal-metrics">Internal metrics<a class="anchor" aria-label="anchor" href="#internal-metrics"></a>
</h3>
<p>Last but not least, there are internal metrics for spatial clustering
evaluation:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_toys</span><span class="op">$</span><span class="va">c_elsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpatialInternalMetrics.html">getSpatialInternalMetrics</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">label</span>, </span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"element"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ELSA"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ELSA</span></span>
<span><span class="co">## the specified variable is considered as categorical...</span></span>
<span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1_elsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpatialInternalMetrics.html">getSpatialInternalMetrics</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p1</span>, </span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"element"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ELSA"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ELSA</span></span>
<span><span class="co">## the specified variable is considered as categorical...</span></span>
<span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p2_elsa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpatialInternalMetrics.html">getSpatialInternalMetrics</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">sp_toys</span><span class="op">$</span><span class="va">p2</span>, </span>
<span>                      location<span class="op">=</span><span class="va">sp_toys</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span>, level<span class="op">=</span><span class="st">"element"</span>,</span>
<span>                      metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ELSA"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">ELSA</span></span>
<span><span class="co">## the specified variable is considered as categorical...</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">p1_elsa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"P1"</span>, color<span class="op">=</span><span class="st">"ELSA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scico</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scico/man/ggplot2-scales.html" class="external-link">scale_color_scico</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"roma"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">c_elsa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"C"</span>, color<span class="op">=</span><span class="st">"ELSA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scico</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scico/man/ggplot2-scales.html" class="external-link">scale_color_scico</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"roma"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sp_toys</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span>
<span>               color<span class="op">=</span><span class="va">p2_elsa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">s</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>,y<span class="op">=</span><span class="st">""</span>, title<span class="op">=</span><span class="st">"P2"</span>, color<span class="op">=</span><span class="st">"ELSA"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scico</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scico/man/ggplot2-scales.html" class="external-link">scale_color_scico</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"roma"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, direction<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p0</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, </span>
<span>          nrow<span class="op">=</span><span class="fl">1</span>, rel_width<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="poem_files/figure-html/unnamed-chunk-27-1.png" width="1344"></p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] cowplot_1.1.3    igraph_2.1.1     ggnetwork_0.5.13 tidyr_1.3.1     </span></span>
<span><span class="co">## [5] dplyr_1.1.4      ggplot2_3.5.1    poem_0.99.17     BiocStyle_2.32.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] Rdpack_2.6.1                DBI_1.2.3                  </span></span>
<span><span class="co">##   [3] deldir_2.0-4                s2_1.1.7                   </span></span>
<span><span class="co">##   [5] rlang_1.1.5                 magrittr_2.0.3             </span></span>
<span><span class="co">##   [7] clue_0.3-66                 matrixStats_1.3.0          </span></span>
<span><span class="co">##   [9] e1071_1.7-9                 compiler_4.4.3             </span></span>
<span><span class="co">##  [11] systemfonts_1.1.0           vctrs_0.6.5                </span></span>
<span><span class="co">##  [13] fclust_2.1.1.1              pkgconfig_2.0.3            </span></span>
<span><span class="co">##  [15] SpatialExperiment_1.14.0    wk_0.9.4                   </span></span>
<span><span class="co">##  [17] crayon_1.5.3                fastmap_1.2.0              </span></span>
<span><span class="co">##  [19] magick_2.8.4                XVector_0.44.0             </span></span>
<span><span class="co">##  [21] labeling_0.4.3              rmarkdown_2.27             </span></span>
<span><span class="co">##  [23] UCSC.utils_1.0.0            ragg_1.3.2                 </span></span>
<span><span class="co">##  [25] purrr_1.0.2                 xfun_0.46                  </span></span>
<span><span class="co">##  [27] bluster_1.14.0              zlibbioc_1.50.0            </span></span>
<span><span class="co">##  [29] cachem_1.1.0                GenomeInfoDb_1.40.1        </span></span>
<span><span class="co">##  [31] jsonlite_1.8.8              highr_0.11                 </span></span>
<span><span class="co">##  [33] DelayedArray_0.30.1         scico_1.5.0                </span></span>
<span><span class="co">##  [35] BiocParallel_1.38.0         pdist_1.2.1                </span></span>
<span><span class="co">##  [37] terra_1.5-21                clevr_0.1.2                </span></span>
<span><span class="co">##  [39] parallel_4.4.3              aricode_1.0.3              </span></span>
<span><span class="co">##  [41] cluster_2.1.6               R6_2.6.1                   </span></span>
<span><span class="co">##  [43] bslib_0.8.0                 boot_1.3-30                </span></span>
<span><span class="co">##  [45] GenomicRanges_1.56.1        jquerylib_0.1.4            </span></span>
<span><span class="co">##  [47] Rcpp_1.0.14                 bookdown_0.40              </span></span>
<span><span class="co">##  [49] SummarizedExperiment_1.34.0 knitr_1.48                 </span></span>
<span><span class="co">##  [51] IRanges_2.38.1              Matrix_1.7-0               </span></span>
<span><span class="co">##  [53] tidyselect_1.2.1            rstudioapi_0.16.0          </span></span>
<span><span class="co">##  [55] abind_1.4-5                 yaml_2.3.10                </span></span>
<span><span class="co">##  [57] codetools_0.2-20            lattice_0.22-6             </span></span>
<span><span class="co">##  [59] tibble_3.2.1                withr_3.0.2                </span></span>
<span><span class="co">##  [61] Biobase_2.64.0              evaluate_0.24.0            </span></span>
<span><span class="co">##  [63] desc_1.4.3                  sf_1.0-6                   </span></span>
<span><span class="co">##  [65] units_0.8-0                 spData_2.3.3               </span></span>
<span><span class="co">##  [67] proxy_0.4-27                elsa_1.1-28                </span></span>
<span><span class="co">##  [69] pillar_1.10.1               BiocManager_1.30.23        </span></span>
<span><span class="co">##  [71] MatrixGenerics_1.16.0       KernSmooth_2.23-24         </span></span>
<span><span class="co">##  [73] DT_0.33                     stats4_4.4.3               </span></span>
<span><span class="co">##  [75] dbscan_1.2-0                generics_0.1.3             </span></span>
<span><span class="co">##  [77] sp_2.1-4                    mclustcomp_0.3.3           </span></span>
<span><span class="co">##  [79] S4Vectors_0.42.1            munsell_0.5.1              </span></span>
<span><span class="co">##  [81] scales_1.3.0                class_7.3-23               </span></span>
<span><span class="co">##  [83] glue_1.8.0                  tools_4.4.3                </span></span>
<span><span class="co">##  [85] BiocNeighbors_1.22.0        fs_1.6.4                   </span></span>
<span><span class="co">##  [87] grid_4.4.3                  spdep_1.3-6                </span></span>
<span><span class="co">##  [89] crosstalk_1.2.1             rbibutils_2.3              </span></span>
<span><span class="co">##  [91] colorspace_2.1-1            SingleCellExperiment_1.26.0</span></span>
<span><span class="co">##  [93] GenomeInfoDbData_1.2.12     raster_3.5-15              </span></span>
<span><span class="co">##  [95] cli_3.6.4                   textshaping_0.3.6          </span></span>
<span><span class="co">##  [97] S4Arrays_1.4.1              gtable_0.3.5               </span></span>
<span><span class="co">##  [99] sass_0.4.9                  digest_0.6.37              </span></span>
<span><span class="co">## [101] BiocGenerics_0.50.0         classInt_0.4-10            </span></span>
<span><span class="co">## [103] SparseArray_1.4.8           farver_2.1.2               </span></span>
<span><span class="co">## [105] rjson_0.2.21                htmlwidgets_1.6.4          </span></span>
<span><span class="co">## [107] htmltools_0.5.8.1           pkgdown_2.1.1              </span></span>
<span><span class="co">## [109] lifecycle_1.0.4             httr_1.4.7                 </span></span>
<span><span class="co">## [111] MASS_7.3-61</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://roseyuan.github.io/" class="external-link">Siyuan Luo</a>, Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
